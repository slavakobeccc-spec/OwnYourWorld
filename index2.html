<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OwnYourWorld ‚Äî –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ 2FA</title>
  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
  <style>
    :root {
      --bg: #f5f7fb;
      --card: #ffffff;
      --text: #1f2937;
      --muted: #6b7280;
      --accent: #4f46e5;
      --accent-hover: #4338ca;
      --border: #e5e7eb;
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #dc3545;
    }

    body.dark {
      --bg: #0f172a;
      --card: #111827;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --accent: #6366f1;
      --accent-hover: #818cf8;
      --border: #1f2937;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: "Segoe UI", system-ui, -apple-system, sans-serif;
    }

    body {
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
      transition: background 0.3s, color 0.3s;
      overflow-x: hidden;
      min-height: 100vh;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 40px 20px;
    }

    header {
      padding: 20px 32px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid var(--border);
      background: var(--card);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
      cursor: pointer;
    }

    .logo h1 {
      font-size: 22px;
      font-weight: 700;
      background: linear-gradient(135deg, var(--accent), #7c3aed);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .nav-links {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .nav-links button {
      background: transparent;
      border: none;
      color: var(--text);
      text-decoration: none;
      font-weight: 500;
      padding: 8px 16px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
      font-size: 14px;
    }

    .nav-links button:hover {
      background: var(--accent);
      color: white;
    }

    .header-actions {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .theme-toggle, .auth-btn {
      background: var(--bg);
      border: 1px solid var(--border);
      padding: 8px 16px;
      border-radius: 10px;
      cursor: pointer;
      color: var(--text);
      font-size: 14px;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .auth-btn.primary {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }

    .theme-toggle:hover, .auth-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    /* –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ 2FA */
    .page-header {
      text-align: center;
      margin-bottom: 40px;
      padding: 60px 0 40px;
      background: linear-gradient(135deg, var(--accent), #7c3aed);
      color: white;
      position: relative;
      overflow: hidden;
    }

    .page-header::before {
      content: '';
      position: absolute;
      top: -50%;
      right: -20%;
      width: 400px;
      height: 400px;
      background: rgba(255,255,255,0.1);
      border-radius: 50%;
    }

    .page-header h1 {
      font-size: 48px;
      margin-bottom: 10px;
      position: relative;
      z-index: 1;
    }

    .page-header p {
      font-size: 20px;
      opacity: 0.9;
      position: relative;
      z-index: 1;
    }

    /* –ö–∞—Ä—Ç–æ—á–∫–∏ —Ñ—É–Ω–∫—Ü–∏–π */
    .cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 30px;
      margin-bottom: 80px;
    }

    .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 20px;
      padding: 28px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.05);
      transition: all 0.3s;
      position: relative;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      min-height: 320px;
    }

    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: linear-gradient(90deg, var(--accent), var(--accent-hover));
    }

    .card:hover {
      transform: translateY(-8px);
      box-shadow: 0 20px 40px rgba(0,0,0,0.1);
    }

    .card h3 {
      margin-bottom: 12px;
      font-size: 22px;
    }

    .card p {
      color: var(--muted);
      margin-bottom: 24px;
      font-size: 15px;
    }

    /* 2FA –ü–ê–ù–ï–õ–¨ */
    .twofa-panel {
      max-width: 800px;
      margin: 0 auto;
      background: var(--card);
      border-radius: 20px;
      padding: 40px;
      border: 1px solid var(--border);
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    }

    .twofa-status {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 20px;
      background: var(--bg);
      border-radius: 12px;
      border: 1px solid var(--border);
      margin-bottom: 30px;
    }

    .twofa-status.enabled {
      border-color: var(--success);
      background: rgba(16, 185, 129, 0.1);
    }

    .twofa-status.disabled {
      border-color: var(--muted);
    }

    .twofa-badge {
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 14px;
      font-weight: 600;
      text-transform: uppercase;
    }

    .twofa-badge.enabled {
      background: var(--success);
      color: white;
    }

    .twofa-badge.disabled {
      background: var(--muted);
      color: white;
    }

    .twofa-section {
      margin-bottom: 40px;
      padding: 30px;
      background: linear-gradient(135deg, rgba(79, 70, 229, 0.05), rgba(124, 58, 237, 0.05));
      border-radius: 16px;
      border: 1px solid var(--border);
    }

    .twofa-section h3 {
      margin-bottom: 20px;
      color: var(--accent);
      font-size: 24px;
    }

    .code-inputs {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin: 20px 0;
    }

    .code-input {
      width: 50px;
      height: 60px;
      text-align: center;
      font-size: 24px;
      font-weight: bold;
      border: 2px solid var(--border);
      border-radius: 10px;
      background: var(--bg);
      color: var(--text);
      transition: all 0.2s;
    }

    .code-input:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
    }

    .code-input.filled {
      border-color: var(--accent);
      background: rgba(79, 70, 229, 0.1);
    }

    .timer {
      color: var(--muted);
      font-size: 14px;
      margin-top: 10px;
      text-align: center;
    }

    .timer.warning {
      color: var(--warning);
    }

    .timer.danger {
      color: var(--danger);
    }

    .btn-group {
      display: flex;
      gap: 15px;
      margin-top: 20px;
    }

    .btn {
      padding: 12px 24px;
      border-radius: 10px;
      border: none;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      flex: 1;
    }

    .btn.primary {
      background: var(--accent);
      color: white;
    }

    .btn.primary:hover {
      background: var(--accent-hover);
      transform: translateY(-2px);
    }

    .btn.secondary {
      background: transparent;
      border: 2px solid var(--accent);
      color: var(--accent);
    }

    .btn.secondary:hover {
      background: var(--accent);
      color: white;
    }

    .btn.danger {
      background: var(--danger);
      color: white;
    }

    .btn.danger:hover {
      background: #c82333;
      transform: translateY(-2px);
    }

    /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.7);
      z-index: 10000;
      align-items: center;
      justify-content: center;
    }

    .modal.active {
      display: flex;
    }

    .modal-content {
      background: var(--card);
      padding: 40px;
      border-radius: 24px;
      max-width: 500px;
      width: 90%;
      position: relative;
      animation: modalSlide 0.3s ease;
    }

    @keyframes modalSlide {
      from { opacity: 0; transform: translateY(-50px); }
      to { opacity: 1; transform: translateY(0); }
    }

    footer {
      text-align: center;
      padding: 40px 32px;
      color: var(--muted);
      font-size: 14px;
      border-top: 1px solid var(--border);
      background: var(--card);
      margin-top: 60px;
    }

    .hidden {
      display: none !important;
    }

    .loading {
      display: inline-block;
      width: 18px;
      height: 18px;
      border: 2px solid white;
      border-top-color: transparent;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-right: 8px;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    @media (max-width: 768px) {
      .page-header h1 {
        font-size: 36px;
      }
      
      .cards {
        grid-template-columns: 1fr;
      }
      
      .twofa-panel {
        padding: 20px;
      }
      
      .btn-group {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ 2FA -->
  <div id="twofaModal" class="modal">
    <div class="modal-content">
      <button class="btn secondary" onclick="closeTwoFAModal()" style="position: absolute; top: 20px; left: 20px;">‚Üê –ù–∞–∑–∞–¥</button>
      
      <h1 style="text-align: center; margin-bottom: 20px;">üîê –î–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è</h1>
      <p style="text-align: center; color: var(--muted); margin-bottom: 30px;">
        –î–ª—è –≤—Ö–æ–¥–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ email
      </p>
      
      <div id="twofaContent">
        <div class="form-group">
          <label>–ö–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ <strong id="twofaEmail"></strong></label>
          <div class="code-inputs">
            <input type="text" maxlength="1" class="code-input" oninput="moveToNext(this, 1)" onkeyup="handleCodeInput(event, 0)">
            <input type="text" maxlength="1" class="code-input" oninput="moveToNext(this, 2)" onkeyup="handleCodeInput(event, 1)">
            <input type="text" maxlength="1" class="code-input" oninput="moveToNext(this, 3)" onkeyup="handleCodeInput(event, 2)">
            <input type="text" maxlength="1" class="code-input" oninput="moveToNext(this, 4)" onkeyup="handleCodeInput(event, 3)">
            <input type="text" maxlength="1" class="code-input" oninput="moveToNext(this, 5)" onkeyup="handleCodeInput(event, 4)">
            <input type="text" maxlength="1" class="code-input" onkeyup="handleCodeInput(event, 5)">
          </div>
          <div class="timer" id="twofaTimer">–ö–æ–¥ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω 5:00</div>
        </div>
        
        <button onclick="verifyTwoFACode()" class="btn primary" id="verify2FABtn">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
        <button onclick="resend2FACode()" class="btn secondary" style="width: 100%; margin-top: 10px;">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥ –ø–æ–≤—Ç–æ—Ä–Ω–æ</button>
      </div>
    </div>
  </div>

  <!-- –û—Å–Ω–æ–≤–Ω–æ–π —Å–∞–π—Ç -->
  <div id="mainSite">
    <header>
      <div class="logo" onclick="navigateTo('home')">
        <h1>OwnYourWorld üîí</h1>
      </div>
      <div class="nav-links">
        <button onclick="navigateTo('home')">–ì–ª–∞–≤–Ω–∞—è</button>
        <button onclick="navigateTo('profile')" id="profileNavBtn" style="display: none;">–ü—Ä–æ—Ñ–∏–ª—å</button>
        <button onclick="navigateTo('twofa')" id="twofaNavBtn" style="display: none;">2FA –ó–∞—â–∏—Ç–∞</button>
        <button onclick="logout()" id="logoutNavBtn" style="display: none;">–í—ã–π—Ç–∏</button>
      </div>
      <div class="header-actions">
        <button class="theme-toggle" onclick="toggleTheme()">üåô –¢–µ–º–∞</button>
        <button class="auth-btn" onclick="showLogin()" id="loginSiteBtn">–í–æ–π—Ç–∏</button>
        <button class="auth-btn primary" onclick="showRegistration()" id="registerSiteBtn">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
      </div>
    </header>

    <!-- –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
    <div id="home" class="page active">
      <div class="page-header">
        <h1>–î–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è</h1>
        <p>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞ –≤–∞—à–µ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞</p>
      </div>
      <div class="container">
        <div class="cards">
          <div class="card">
            <h3>üîê –ß—Ç–æ —Ç–∞–∫–æ–µ 2FA?</h3>
            <p>
              –î–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–æ–±–∞–≤–ª—è–µ—Ç –≤—Ç–æ—Ä–æ–π —É—Ä–æ–≤–µ–Ω—å –∑–∞—â–∏—Ç—ã –∫ –≤–∞—à–µ–º—É –∞–∫–∫–∞—É–Ω—Ç—É. 
              –î–∞–∂–µ –µ—Å–ª–∏ –∫—Ç–æ-—Ç–æ —É–∑–Ω–∞–µ—Ç –≤–∞—à –ø–∞—Ä–æ–ª—å, –æ–Ω–∏ –Ω–µ —Å–º–æ–≥—É—Ç –≤–æ–π—Ç–∏ –±–µ–∑ –∫–æ–¥–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.
            </p>
          </div>
          
          <div class="card">
            <h3>üìß –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ Email</h3>
            <p>
              –ü—Ä–∏ –∫–∞–∂–¥–æ–º –≤—Ö–æ–¥–µ –º—ã –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π 6-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥ –Ω–∞ –≤–∞—à—É –ø–æ—á—Ç—É. 
              –¢–æ–ª—å–∫–æ –≤–≤–µ–¥—è —ç—Ç–æ—Ç –∫–æ–¥, –≤—ã —Å–º–æ–∂–µ—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∞–∫–∫–∞—É–Ω—Ç—É.
            </p>
          </div>
          
          <div class="card">
            <h3>‚ö° –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞</h3>
            <p>
              –í–∫–ª—é—á–∏—Ç–µ 2FA –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø—Ä–æ—Ñ–∏–ª—è –∑–∞ 2 –º–∏–Ω—É—Ç—ã. 
              –í—ã –≤—Å–µ–≥–¥–∞ –º–æ–∂–µ—Ç–µ –æ—Ç–∫–ª—é—á–∏—Ç—å –∑–∞—â–∏—Ç—É, –µ—Å–ª–∏ –æ–Ω–∞ –≤–∞–º –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–∞.
            </p>
          </div>
        </div>

        <div class="twofa-panel">
          <h2 style="text-align: center; margin-bottom: 30px; color: var(--accent);">
            –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
          </h2>
          
          <div class="twofa-status" id="twofaStatus">
            <div>
              <h3 style="margin-bottom: 5px;">–°—Ç–∞—Ç—É—Å 2FA</h3>
              <p style="color: var(--muted); font-size: 14px;" id="twofaStatusText">
                –î–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç
              </p>
            </div>
            <div class="twofa-badge disabled" id="twofaBadge">–í—ã–∫–ª</div>
          </div>
          
          <div class="twofa-section">
            <h3>–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?</h3>
            <p style="color: var(--muted); margin-bottom: 20px;">
              1. –í–∫–ª—é—á–∏—Ç–µ 2FA –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø—Ä–æ—Ñ–∏–ª—è<br>
              2. –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –≤—Ö–æ–¥–µ –ø–æ–ª—É—á–∏—Ç–µ –∫–æ–¥ –Ω–∞ email<br>
              3. –í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤—Ö–æ–¥–∞<br>
              4. –ê–∫–∫–∞—É–Ω—Ç –∑–∞—â–∏—â–µ–Ω –æ—Ç –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
            </p>
            
            <div class="btn-group">
              <button class="btn primary" onclick="enable2FA()" id="enable2FABtn" disabled>–í–∫–ª—é—á–∏—Ç—å 2FA</button>
              <button class="btn secondary" onclick="disable2FA()" id="disable2FABtn" disabled>–í—ã–∫–ª—é—á–∏—Ç—å 2FA</button>
            </div>
          </div>
          
          <div style="text-align: center; margin-top: 40px;">
            <p style="color: var(--muted);">
              üí° <strong>–°–æ–≤–µ—Ç:</strong> –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ 2FA –¥–ª—è –≤–∞–∂–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤!
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- –ü—Ä–æ—Ñ–∏–ª—å -->
    <div id="profile" class="page">
      <div class="page-header">
        <h1>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</h1>
        <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—â–∏—Ç–æ–π –∞–∫–∫–∞—É–Ω—Ç–∞</p>
      </div>
      <div class="container">
        <div class="twofa-panel">
          <div class="twofa-status enabled" id="profileTwoFAStatus">
            <div>
              <h3 style="margin-bottom: 5px;">–î–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è</h3>
              <p style="color: var(--muted); font-size: 14px;" id="profileTwoFAStatusText">
                –ó–∞—â–∏—Ç–∞ –∞–∫–∫–∞—É–Ω—Ç–∞ –≤–∫–ª—é—á–µ–Ω–∞
              </p>
            </div>
            <div class="twofa-badge enabled" id="profileTwoFABadge">–í–∫–ª</div>
          </div>
          
          <div class="twofa-section">
            <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 2FA</h3>
            <p style="color: var(--muted); margin-bottom: 20px;">
              –ü—Ä–∏ –≤–∫–ª—é—á–µ–Ω–Ω–æ–π 2FA –∫–∞–∂–¥—ã–π –≤—Ö–æ–¥ –≤ –∞–∫–∫–∞—É–Ω—Ç —Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–æ email.
              –ö–æ–¥ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –≤ —Ç–µ—á–µ–Ω–∏–µ 5 –º–∏–Ω—É—Ç.
            </p>
            
            <div class="btn-group">
              <button class="btn secondary" onclick="toggle2FA()" id="toggle2FABtn">–í—ã–∫–ª—é—á–∏—Ç—å 2FA</button>
              <button class="btn primary" onclick="test2FA()">–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å 2FA</button>
            </div>
          </div>
          
          <div class="twofa-section">
            <h3>–ò—Å—Ç–æ—Ä–∏—è –≤—Ö–æ–¥–æ–≤</h3>
            <div id="loginHistory" style="max-height: 300px; overflow-y: auto; padding: 15px; background: var(--bg); border-radius: 10px;">
              <p style="color: var(--muted); text-align: center; padding: 20px;">
                –ò—Å—Ç–æ—Ä–∏—è –≤—Ö–æ–¥–æ–≤ –ø–æ–∫–∞ –ø—É—Å—Ç–∞
              </p>
            </div>
          </div>
          
          <div style="margin-top: 40px; padding-top: 20px; border-top: 1px solid var(--border);">
            <button class="btn danger" onclick="logout()" style="width: 100%;">
              –í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞
            </button>
          </div>
        </div>
      </div>
    </div>

    <footer>
      <p>¬© 2024 OwnYourWorld. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
      <p style="margin-top: 10px; font-size: 12px; color: var(--muted);">
        üîí –í–∞—à–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ‚Äî –Ω–∞—à –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
      </p>
    </footer>
  </div>

  <script>
    // ==================== –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ====================
    const EMAILJS_CONFIG = {
      PUBLIC_KEY: "pT9KT_F9cgmvnBB_S",
      SERVICE_ID: "service_uf8mvkn", 
      TEMPLATE_ID: "template_6fe1rc9"
    };
    
    let currentUser = null;
    let isLoggedIn = false;
    let twoFATimer = null;
    let twoFATimeLeft = 300; // 5 –º–∏–Ω—É—Ç –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
    let twoFACode = '';

    // ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ====================
    document.addEventListener('DOMContentLoaded', function() {
      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è EmailJS
      emailjs.init(EMAILJS_CONFIG.PUBLIC_KEY);
      console.log('‚úÖ EmailJS –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
      
      // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–º—ã
      if (localStorage.getItem('theme') === 'dark') {
        document.body.classList.add('dark');
        document.querySelector('.theme-toggle').innerHTML = '‚òÄÔ∏è –¢–µ–º–∞';
      }
      
      // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏–Ω–∞
      checkLoginStatus();
      
      // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
      const hash = window.location.hash.substring(1);
      if (hash && document.getElementById(hash)) {
        navigateTo(hash);
      }
    });

    // ==================== –°–ò–°–¢–ï–ú–ê –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ô ====================
    function getAllUsers() {
      const users = localStorage.getItem('allUsers');
      return users ? JSON.parse(users) : [];
    }

    function saveAllUsers(users) {
      localStorage.setItem('allUsers', JSON.stringify(users));
    }

    function getCurrentUser() {
      const userId = localStorage.getItem('userId');
      if (!userId) return null;
      
      const users = getAllUsers();
      return users.find(u => u.id === userId);
    }

    function saveCurrentUser(user) {
      const users = getAllUsers();
      const index = users.findIndex(u => u.id === user.id);
      if (index !== -1) {
        users[index] = user;
        saveAllUsers(users);
      }
    }

    function addLoginHistory(userId, action) {
      const users = getAllUsers();
      const userIndex = users.findIndex(u => u.id === userId);
      
      if (userIndex !== -1) {
        if (!users[userIndex].loginHistory) {
          users[userIndex].loginHistory = [];
        }
        
        users[userIndex].loginHistory.unshift({
          action: action,
          timestamp: new Date().toISOString(),
          ip: '127.0.0.1',
          userAgent: navigator.userAgent
        });
        
        // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é 50 –∑–∞–ø–∏—Å—è–º–∏
        if (users[userIndex].loginHistory.length > 50) {
          users[userIndex].loginHistory = users[userIndex].loginHistory.slice(0, 50);
        }
        
        saveAllUsers(users);
      }
    }

    // ==================== 2FA –°–ò–°–¢–ï–ú–ê ====================
    function generate2FACode() {
      return Math.floor(100000 + Math.random() * 900000).toString();
    }

    async function send2FACode(email, username) {
      twoFACode = generate2FACode();
      twoFATimeLeft = 300; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ç–∞–π–º–µ—Ä
      
      try {
        const templateParams = {
          email: email,
          passcode: twoFACode,
          time: getCurrentTime(),
          to_name: username,
          from_name: 'OwnYourWorld Security'
        };
        
        const response = await emailjs.send(
          EMAILJS_CONFIG.SERVICE_ID,
          EMAILJS_CONFIG.TEMPLATE_ID,
          templateParams
        );
        
        console.log('‚úÖ –ö–æ–¥ 2FA –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω');
        start2FATimer();
        return true;
      } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–æ–¥–∞ 2FA:', error);
        
        // –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–¥
        alert(`üìß –¢–ï–°–¢–û–í–´–ô –†–ï–ñ–ò–ú\n–ö–æ–¥ 2FA –¥–ª—è ${email}: ${twoFACode}\n\n–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç –∫–æ–¥ –¥–ª—è –≤—Ö–æ–¥–∞`);
        start2FATimer();
        return true;
      }
    }

    function start2FATimer() {
      clearInterval(twoFATimer);
      twoFATimeLeft = 300;
      
      twoFATimer = setInterval(() => {
        twoFATimeLeft--;
        update2FATimer();
        
        if (twoFATimeLeft <= 0) {
          clearInterval(twoFATimer);
          document.getElementById('twofaTimer').textContent = '–ö–æ–¥ –∏—Å—Ç–µ–∫';
          document.getElementById('twofaTimer').className = 'timer danger';
          twoFACode = '';
        }
      }, 1000);
      
      update2FATimer();
    }

    function update2FATimer() {
      const timerElement = document.getElementById('twofaTimer');
      if (!timerElement) return;
      
      const minutes = Math.floor(twoFATimeLeft / 60);
      const seconds = twoFATimeLeft % 60;
      
      timerElement.textContent = `–ö–æ–¥ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω ${minutes}:${seconds.toString().padStart(2, '0')}`;
      
      if (twoFATimeLeft < 60) {
        timerElement.className = 'timer danger';
      } else if (twoFATimeLeft < 180) {
        timerElement.className = 'timer warning';
      } else {
        timerElement.className = 'timer';
      }
    }

    function getCurrentTime() {
      const now = new Date();
      const hours = now.getHours().toString().padStart(2, '0');
      const minutes = now.getMinutes().toString().padStart(2, '0');
      return `${hours}:${minutes}`;
    }

    // ==================== –í–•–û–î –° 2FA ====================
    async function loginWith2FA(email, password) {
      const users = getAllUsers();
      const user = users.find(u => u.email === email && u.password === password);
      
      if (!user) {
        alert('–ù–µ–≤–µ—Ä–Ω—ã–π email –∏–ª–∏ –ø–∞—Ä–æ–ª—å!');
        return false;
      }
      
      // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è 2FA
      sessionStorage.setItem('tempUserId', user.id);
      sessionStorage.setItem('tempUsername', user.username);
      sessionStorage.setItem('tempEmail', user.email);
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤–∫–ª—é—á–µ–Ω–∞ –ª–∏ 2FA
      if (user.twoFAEnabled) {
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª–∫—É 2FA
        document.getElementById('twofaEmail').textContent = user.email;
        document.getElementById('twofaModal').classList.add('active');
        
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–æ–¥
        await send2FACode(user.email, user.username);
        return '2FA_REQUIRED';
      } else {
        // –í—Ö–æ–¥ –±–µ–∑ 2FA
        completeLogin(user);
        return true;
      }
    }

    function verifyTwoFACode() {
      const codeInputs = document.querySelectorAll('.code-input');
      const enteredCode = Array.from(codeInputs).map(input => input.value).join('');
      
      if (enteredCode.length !== 6) {
        alert('–í–≤–µ–¥–∏—Ç–µ –ø–æ–ª–Ω—ã–π 6-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥!');
        return;
      }
      
      if (enteredCode !== twoFACode) {
        alert('–ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è!');
        return;
      }
      
      // –ö–æ–¥ –≤–µ—Ä–Ω—ã–π, –∑–∞–≤–µ—Ä—à–∞–µ–º –≤—Ö–æ–¥
      const userId = sessionStorage.getItem('tempUserId');
      const users = getAllUsers();
      const user = users.find(u => u.id === userId);
      
      if (user) {
        closeTwoFAModal();
        completeLogin(user);
      }
    }

    function completeLogin(user) {
      localStorage.setItem('userId', user.id);
      localStorage.setItem('username', user.username);
      localStorage.setItem('email', user.email);
      localStorage.setItem('isLoggedIn', 'true');
      
      currentUser = user;
      isLoggedIn = true;
      
      // –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–ø–∏—Å—å –≤ –∏—Å—Ç–æ—Ä–∏—é
      addLoginHistory(user.id, '–£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É');
      
      // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
      updateNavigation();
      showNotification('–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω', '–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!');
      
      // –û—á–∏—â–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
      sessionStorage.removeItem('tempUserId');
      sessionStorage.removeItem('tempUsername');
      sessionStorage.removeItem('tempEmail');
      
      // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ –≥–ª–∞–≤–Ω—É—é
      setTimeout(() => navigateTo('home'), 500);
    }

    function closeTwoFAModal() {
      document.getElementById('twofaModal').classList.remove('active');
      clearInterval(twoFATimer);
      
      // –û—á–∏—â–∞–µ–º –ø–æ–ª—è –≤–≤–æ–¥–∞
      document.querySelectorAll('.code-input').forEach(input => {
        input.value = '';
        input.classList.remove('filled');
      });
      
      // –û—á–∏—â–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
      sessionStorage.removeItem('tempUserId');
      sessionStorage.removeItem('tempUsername');
      sessionStorage.removeItem('tempEmail');
    }

    function resend2FACode() {
      const email = sessionStorage.getItem('tempEmail');
      const username = sessionStorage.getItem('tempUsername');
      
      if (email && username) {
        send2FACode(email, username);
        showNotification('–ö–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω', '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∞—à—É –ø–æ—á—Ç—É');
      }
    }

    // ==================== –£–ü–†–ê–í–õ–ï–ù–ò–ï 2FA ====================
    function enable2FA() {
      const user = getCurrentUser();
      if (!user) {
        alert('–°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç!');
        return;
      }
      
      if (user.twoFAEnabled) {
        alert('2FA —É–∂–µ –≤–∫–ª—é—á–µ–Ω–∞!');
        return;
      }
      
      if (confirm('–í–∫–ª—é—á–∏—Ç—å –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é?\n\n–ü—Ä–∏ –∫–∞–∂–¥–æ–º –≤—Ö–æ–¥–µ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –∫–æ–¥ —Å email.')) {
        user.twoFAEnabled = true;
        user.twoFAEnabledAt = new Date().toISOString();
        saveCurrentUser(user);
        
        update2FAStatus();
        showNotification('2FA –≤–∫–ª—é—á–µ–Ω–∞', '–ê–∫–∫–∞—É–Ω—Ç –∑–∞—â–∏—â–µ–Ω');
        
        // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
        addLoginHistory(user.id, '–í–∫–ª—é—á–∏–ª –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é');
      }
    }

    function disable2FA() {
      const user = getCurrentUser();
      if (!user) return;
      
      if (!user.twoFAEnabled) {
        alert('2FA —É–∂–µ –≤—ã–∫–ª—é—á–µ–Ω–∞!');
        return;
      }
      
      if (confirm('–í—ã–∫–ª—é—á–∏—Ç—å –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é?\n\n–ê–∫–∫–∞—É–Ω—Ç —Å—Ç–∞–Ω–µ—Ç –º–µ–Ω–µ–µ –∑–∞—â–∏—â–µ–Ω–Ω—ã–º.')) {
        user.twoFAEnabled = false;
        user.twoFADisabledAt = new Date().toISOString();
        saveCurrentUser(user);
        
        update2FAStatus();
        showNotification('2FA –≤—ã–∫–ª—é—á–µ–Ω–∞', '–ó–∞—â–∏—Ç–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞');
        
        // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
        addLoginHistory(user.id, '–í—ã–∫–ª—é—á–∏–ª –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é');
      }
    }

    function toggle2FA() {
      const user = getCurrentUser();
      if (!user) return;
      
      if (user.twoFAEnabled) {
        disable2FA();
      } else {
        enable2FA();
      }
    }

    function test2FA() {
      const user = getCurrentUser();
      if (!user) return;
      
      if (!user.twoFAEnabled) {
        alert('–í–∫–ª—é—á–∏—Ç–µ 2FA —Å–Ω–∞—á–∞–ª–∞!');
        return;
      }
      
      // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–µ—Å—Å–∏–∏
      const tempUserId = localStorage.getItem('userId');
      const tempUsername = localStorage.getItem('username');
      const tempEmail = localStorage.getItem('email');
      const tempLoggedIn = localStorage.getItem('isLoggedIn');
      
      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
      sessionStorage.setItem('tempUserId', user.id);
      sessionStorage.setItem('tempUsername', user.username);
      sessionStorage.setItem('tempEmail', user.email);
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª–∫—É 2FA
      document.getElementById('twofaEmail').textContent = user.email;
      document.getElementById('twofaModal').classList.add('active');
      
      // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–æ–¥
      send2FACode(user.email, user.username);
      
      // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–µ—Å—Å–∏—é –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∞
      setTimeout(() => {
        if (tempUserId) {
          localStorage.setItem('userId', tempUserId);
          localStorage.setItem('username', tempUsername);
          localStorage.setItem('email', tempEmail);
          localStorage.setItem('isLoggedIn', tempLoggedIn);
        }
      }, 1000);
    }

    function update2FAStatus() {
      const user = getCurrentUser();
      
      if (!user) {
        // –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
        document.getElementById('twofaStatusText').textContent = '–î–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç';
        document.getElementById('twofaBadge').textContent = '–í—ã–∫–ª';
        document.getElementById('twofaBadge').className = 'twofa-badge disabled';
        document.getElementById('twofaStatus').className = 'twofa-status disabled';
        document.getElementById('enable2FABtn').disabled = true;
        document.getElementById('disable2FABtn').disabled = true;
        return;
      }
      
      if (user.twoFAEnabled) {
        // 2FA –≤–∫–ª—é—á–µ–Ω–∞
        document.getElementById('twofaStatusText').textContent = '–ó–∞—â–∏—Ç–∞ –∞–∫–∫–∞—É–Ω—Ç–∞ –≤–∫–ª—é—á–µ–Ω–∞';
        document.getElementById('twofaBadge').textContent = '–í–∫–ª';
        document.getElementById('twofaBadge').className = 'twofa-badge enabled';
        document.getElementById('twofaStatus').className = 'twofa-status enabled';
        document.getElementById('enable2FABtn').disabled = true;
        document.getElementById('disable2FABtn').disabled = false;
        
        // –í –ø—Ä–æ—Ñ–∏–ª–µ
        document.getElementById('profileTwoFAStatusText').textContent = '–ó–∞—â–∏—Ç–∞ –∞–∫–∫–∞—É–Ω—Ç–∞ –≤–∫–ª—é—á–µ–Ω–∞';
        document.getElementById('profileTwoFABadge').textContent = '–í–∫–ª';
        document.getElementById('profileTwoFAStatus').className = 'twofa-status enabled';
        document.getElementById('toggle2FABtn').textContent = '–í—ã–∫–ª—é—á–∏—Ç—å 2FA';
      } else {
        // 2FA –≤—ã–∫–ª—é—á–µ–Ω–∞
        document.getElementById('twofaStatusText').textContent = '–ó–∞—â–∏—Ç–∞ –∞–∫–∫–∞—É–Ω—Ç–∞ –≤—ã–∫–ª—é—á–µ–Ω–∞';
        document.getElementById('twofaBadge').textContent = '–í—ã–∫–ª';
        document.getElementById('twofaBadge').className = 'twofa-badge disabled';
        document.getElementById('twofaStatus').className = 'twofa-status disabled';
        document.getElementById('enable2FABtn').disabled = false;
        document.getElementById('disable2FABtn').disabled = true;
        
        // –í –ø—Ä–æ—Ñ–∏–ª–µ
        document.getElementById('profileTwoFAStatusText').textContent = '–ó–∞—â–∏—Ç–∞ –∞–∫–∫–∞—É–Ω—Ç–∞ –≤—ã–∫–ª—é—á–µ–Ω–∞';
        document.getElementById('profileTwoFABadge').textContent = '–í—ã–∫–ª';
        document.getElementById('profileTwoFAStatus').className = 'twofa-status disabled';
        document.getElementById('toggle2FABtn').textContent = '–í–∫–ª—é—á–∏—Ç—å 2FA';
      }
    }

    // ==================== –ò–ù–¢–ï–†–§–ï–ô–° ====================
    function checkLoginStatus() {
      const savedLogin = localStorage.getItem('isLoggedIn');
      if (savedLogin === 'true') {
        currentUser = getCurrentUser();
        isLoggedIn = true;
        updateNavigation();
        update2FAStatus();
        loadLoginHistory();
      }
    }

    function updateNavigation() {
      const profileBtn = document.getElementById('profileNavBtn');
      const twofaBtn = document.getElementById('twofaNavBtn');
      const logoutBtn = document.getElementById('logoutNavBtn');
      const loginBtn = document.getElementById('loginSiteBtn');
      const registerBtn = document.getElementById('registerSiteBtn');
      
      if (isLoggedIn) {
        if (profileBtn) profileBtn.style.display = 'block';
        if (twofaBtn) twofaBtn.style.display = 'block';
        if (logoutBtn) logoutBtn.style.display = 'block';
        if (loginBtn) loginBtn.style.display = 'none';
        if (registerBtn) registerBtn.style.display = 'none';
      } else {
        if (profileBtn) profileBtn.style.display = 'none';
        if (twofaBtn) twofaBtn.style.display = 'none';
        if (logoutBtn) logoutBtn.style.display = 'none';
        if (loginBtn) loginBtn.style.display = 'block';
        if (registerBtn) registerBtn.style.display = 'block';
      }
      
      update2FAStatus();
    }

    function navigateTo(pageId) {
      document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
      const targetPage = document.getElementById(pageId);
      if (targetPage) {
        targetPage.classList.add('active');
        history.pushState({page: pageId}, '', `#${pageId}`);
        window.scrollTo(0, 0);
      }
    }

    function showLogin() {
      const email = prompt('–í–≤–µ–¥–∏—Ç–µ email:');
      if (!email) return;
      
      const password = prompt('–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å:');
      if (!password) return;
      
      loginWith2FA(email, password);
    }

    function showRegistration() {
      alert('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ (index.html)');
    }

    function logout() {
      if (confirm('–í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞?')) {
        localStorage.removeItem('userId');
        localStorage.removeItem('username');
        localStorage.removeItem('email');
        localStorage.removeItem('isLoggedIn');
        
        currentUser = null;
        isLoggedIn = false;
        
        updateNavigation();
        showNotification('–í—ã—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω', '–î–æ –≤—Å—Ç—Ä–µ—á–∏!');
        navigateTo('home');
      }
    }

    function toggleTheme() {
      const body = document.body;
      const themeToggle = document.querySelector('.theme-toggle');
      
      if (body.classList.contains('dark')) {
        body.classList.remove('dark');
        themeToggle.innerHTML = 'üåô –¢–µ–º–∞';
        localStorage.setItem('theme', 'light');
      } else {
        body.classList.add('dark');
        themeToggle.innerHTML = '‚òÄÔ∏è –¢–µ–º–∞';
        localStorage.setItem('theme', 'dark');
      }
    }

    function loadLoginHistory() {
      const user = getCurrentUser();
      if (!user || !user.loginHistory) return;
      
      const historyContainer = document.getElementById('loginHistory');
      if (!historyContainer) return;
      
      const historyHTML = user.loginHistory.map(entry => `
        <div style="padding: 10px; border-bottom: 1px solid var(--border);">
          <div style="display: flex; justify-content: space-between; align-items: center;">
            <strong>${entry.action}</strong>
            <span style="color: var(--muted); font-size: 12px;">
              ${new Date(entry.timestamp).toLocaleString('ru-RU')}
            </span>
          </div>
          <div style="color: var(--muted); font-size: 12px; margin-top: 5px;">
            IP: ${entry.ip} ‚Ä¢ ${entry.userAgent.substring(0, 50)}...
          </div>
        </div>
      `).join('');
      
      historyContainer.innerHTML = historyHTML;
    }

    // ==================== –ü–û–ú–û–©–ù–ò–ö–ò ====================
    function moveToNext(input, nextIndex) {
      if (input.value.length === 1) {
        input.classList.add('filled');
        const nextInput = document.querySelectorAll('.code-input')[nextIndex];
        if (nextInput) nextInput.focus();
      } else {
        input.classList.remove('filled');
      }
    }

    function handleCodeInput(event, index) {
      const input = event.target;
      const inputs = document.querySelectorAll('.code-input');
      
      if (event.key === 'Backspace' && !input.value && index > 0) {
        inputs[index - 1].focus();
      }
    }

    function showNotification(title, message) {
      const notification = document.createElement('div');
      notification.style.cssText = `
        position: fixed; top: 20px; right: 20px; background: var(--card); color: var(--text);
        padding: 16px 24px; border-radius: 12px; border-left: 4px solid var(--accent);
        box-shadow: 0 8px 25px rgba(0,0,0,0.2); z-index: 10000; animation: slideIn 0.3s ease;
        max-width: 300px; border: 1px solid var(--border);
      `;
      notification.innerHTML = `
        <div style="font-weight: bold; margin-bottom: 8px;">‚úÖ ${title}</div>
        <div style="color: var(--muted); font-size: 14px;">${message}</div>
      `;
      document.body.appendChild(notification);
      setTimeout(() => {
        notification.style.animation = 'slideOut 0.3s ease';
        setTimeout(() => document.body.removeChild(notification), 300);
      }, 3000);
    }

    // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏
    const style = document.createElement('style');
    style.textContent = `
      @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
      @keyframes slideOut { from { transform: translateX(0); opacity: 1; } to { transform: translateX(100%); opacity: 0; } }
    `;
    document.head.appendChild(style);

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏—Å—Ç–æ—Ä–∏–∏
    window.addEventListener('popstate', function(event) {
      if (event.state && event.state.page) {
        navigateTo(event.state.page);
      }
    });
  </script>
</body>
</html>